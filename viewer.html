<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viewer (True Broadcast)</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <div class="card">
        <div class="card-header"><span class="title-text">./view_live.sh</span></div>
        <div class="card-body">
            <h2 id="status">–û–∂–∏–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏...</h2>
            <img id="streamImage" style="width: 100%; background-color: #000; border-radius: 8px; min-height: 200px;">
        </div>
    </div>
</div>
<script>
    const statusEl = document.getElementById('status');
    const image = document.getElementById('streamImage');

    // !!! –í–ê–® –†–ê–ë–û–ß–ò–ô –ê–î–†–ï–° –° REPLIT –£–ñ–ï –í–°–¢–ê–í–õ–ï–ù !!!
    const SERVER_URL = 'wss://9d2488b5-3986-4269-bfdd-d01f421e0f4c-00-asck2nhxkvc6.pike.replit.dev/';
    
    function connect() {
        const ws = new WebSocket(SERVER_URL);

        ws.onopen = () => { statusEl.textContent = "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ. –û–∂–∏–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ..."; };
        ws.onmessage = event => {
            if (event.data === 'stream_ended') {
                statusEl.textContent = "–¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5—Å...";
                image.src = '';
                setTimeout(connect, 5000);
                return;
            }
            statusEl.style.display = 'none';
            image.src = event.data;
        };
        ws.onclose = () => {
            statusEl.style.display = 'block';
            statusEl.textContent = "üî¥ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ. –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ 5—Å...";
            setTimeout(connect, 5000);
        };
        ws.onerror = () => {
             statusEl.textContent = "‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.";
        };
    }

    connect();
</script>
</body>
</html>
